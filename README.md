# Sales Order API

API para gerenciamento de pedidos.

## üöÄ Deploy

**URL do Projeto:** https://sales-order-api-production.up.railway.app

### Endpoints de Verifica√ß√£o:
- **Healthcheck:** https://sales-order-api-production.up.railway.app/healthcheck - Verifica conex√£o com o banco
- **Documenta√ß√£o:** https://sales-order-api-production.up.railway.app/api-docs - Swagger UI 

### Deploy na Railway

O projeto est√° configurado para deploy autom√°tico via GitHub na Railway usando Docker.

**Benef√≠cios do Multi-stage Build:**
- Reduz tamanho da imagem final
- Separa depend√™ncias de desenvolvimento e produ√ß√£o
- Otimiza cache do Docker
- Melhora seguran√ßa removendo ferramentas de build

## üõ†Ô∏è Executando Localmente

### Pr√©-requisitos
- Node.js 20+
- Yarn
- Docker
  
### Com Yarn (Recomendado)
```bash
.env 
MONGODB_URI=mongodb://localhost:27017/sales
# Instalar depend√™ncias
yarn install

# Executar em desenvolvimento
yarn dev

# Executar testes
yarn test:coverage

# Executar build
yarn build

# Executar a vers√£o do build
yarn start
```

### Com Docker
```bash
# Construir e executar com banco
docker-compose up --build

# Ou separadamente:
# 1. Construir primeiro
docker-compose build

# 2. Executar apenas a aplica√ß√£o (MongoDB j√° deve estar rodando)
docker-compose up app

# Executar em background
docker-compose up -d --build

# Parar todos os servi√ßos
docker-compose down
```

## üß™ Testes

O projeto possui cobertura de testes:

### Tipos de Teste
- **Unit√°rios:** Testam componentes isolados
- **Integra√ß√£o:** Testam fluxos completos
- **E2E:** Testam cen√°rios end-to-end

### Cobertura M√≠nima
- **70%** de cobertura obrigat√≥ria
- Verificado pelo Husky no commit
- Relat√≥rios gerados automaticamente

### Executar Testes
```bash
# Todos os testes
yarn test

# Testes com cobertura
yarn test:coverage

# Testes em watch mode
yarn test:watch
```

## üèóÔ∏è Arquitetura

### Princ√≠pios de Clean Architecture + SOLID

```
src/
‚îú‚îÄ‚îÄ domain/          # Regras de neg√≥cio
‚îÇ   ‚îú‚îÄ‚îÄ entities/    # Entidades do dom√≠nio
‚îÇ   ‚îú‚îÄ‚îÄ useCases/    # Casos de uso
‚îÇ   ‚îî‚îÄ‚îÄ repositories/# Interfaces de reposit√≥rio
‚îú‚îÄ‚îÄ data/            # Implementa√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ repositories/# Reposit√≥rios concretos
‚îÇ   ‚îî‚îÄ‚îÄ useCases/    # Implementa√ß√µes dos casos de uso
‚îú‚îÄ‚îÄ presentation/    # Controllers e DTOs
‚îî‚îÄ‚îÄ infra/          # Configura√ß√µes externas
    ‚îî‚îÄ‚îÄ db/         # Banco de dados
```
Pontos de melhoria: 
- Separar useCase em servi√ßos
- Alterar algumas tipagens gen√©ricas
## üìã Regras de Neg√≥cio

### Upload de Pedidos
1. **Valida√ß√£o de Arquivo:**
   - Apenas arquivos `.txt`
   - Formato fixo de largura
   - Campos: user_id(10), name(45), order_id(10), product_id(10), value(12), date(8)

2. **Processamento:**
   - Leitura linha por linha
   - Valida√ß√£o de formato
   - Convers√£o de data (YYYYMMDD ‚Üí YYYY-MM-DD)
   - Agrupamento por usu√°rio e pedido

3. **Persist√™ncia:**
   - Inser√ß√£o em lotes de 100
   - Tratamento de duplicatas

### Busca de Pedidos
1. **Filtros Dispon√≠veis:**
   - `/`: Por padr√£o traz todos os dados
   - `user_id`: ID do usu√°rio
   - `order_id`: ID do pedido
   - `start/end`: Per√≠odo de datas
   - `page`: Pagina√ß√£o
   - `all`: Retorna todos os resultados
   - √â poss√≠vel combinar os filtros

2. **L√≥gica de Pagina√ß√£o:**
   - Padr√£o sempre na p√°gina 1
   - Limite de 100 itens por p√°gina
   - Retorna metadados de pagina√ß√£o

3. **Agrega√ß√£o:**
   - Agrupa por usu√°rio
   - Soma valores por pedido
   - Estrutura hier√°rquica

## üõ£Ô∏è Rotas da API

### Healthcheck
```http
GET /healthcheck
```
**Resposta:**
```json
{
  "status": "OK",
  "db": "OK",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "app": "Sales Order API",
  "version": "1.0.0",
  "environment": "development"
}
```

### Upload de Pedidos
```http
POST /order/upload
Content-Type: multipart/form-data

file: [arquivo.txt]
```
**Resposta:**
```json
{
  "message": "Arquivo TXT processado e salvo no MongoDB com sucesso",
  "fileName": "pedidos.txt",
  "fileSize": 12345,
  "lines": 1000,
  "data": [
    {
      "user_id": 1,
      "name": "Marcelo",
      "orders": [
        {
          "order_id": 10,
          "total": "150.00",
          "date": "2024-01-15",
          "products": [
            {
              "product_id": 100,
              "value": "50.00"
            },
            {
              "product_id": 101,
              "value": "100.00"
            }
          ]
        },
        {
          "order_id": 11,
          "total": "75.50",
          "date": "2024-01-16",
          "products": [
            {
              "product_id": 102,
              "value": "75.50"
            }
          ]
        }
      ]
    }
  ],
  "savedOrders": 4,
  "skippedOrders": 0
}
```

### Busca de Pedidos
```http
GET /order/search?user_id=1&start=2024-01-01&end=2024-01-31&page=1
```
**Resposta:**
```json
{
  "pagination": {
    "totalPages": 3,
    "currentPage": 1,
    "totalItems": 250,
    "itemsPerPage": 100
  },
  "data": [...]
}
```

### Exemplo de Resposta da API

#### **Upload de Pedidos:**
```json
{
  "message": "Arquivo TXT processado e salvo no MongoDB com sucesso",
  "fileName": "pedidos.txt",
  "fileSize": 12345,
  "lines": 1000,
  "data": [
    {
      "user_id": 1,
      "name": "Marcelo",
      "orders": [
        {
          "order_id": 10,
          "total": "150.00",
          "date": "2024-01-15",
          "products": [
            {
              "product_id": 100,
              "value": "50.00"
            },
            {
              "product_id": 101,
              "value": "100.00"
            }
          ]
        },
        {
          "order_id": 11,
          "total": "75.50",
          "date": "2024-01-16",
          "products": [
            {
              "product_id": 102,
              "value": "75.50"
            }
          ]
        }
      ]
    }
  ],
  "savedOrders": 4,
  "skippedOrders": 0
}
```

#### **Busca de Pedidos:**
```json
[
  {
    "user_id": 1,
    "name": "Jo√£o Silva",
    "orders": [
      {
        "order_id": 10,
        "total": "150.00",
        "date": "2024-01-15",
        "products": [
          {
            "product_id": 100,
            "value": "50.00"
          },
          {
            "product_id": 101,
            "value": "100.00"
          }
        ]
      }
    ]
  }
]
```

### üìä Registro no MongoDB

#### **Documento Individual (Collection: orders):**
```json
{
  "_id": ObjectId("65f1234567890abcdef12345"),
  "user_id": 1,
  "name": "Marcelo",
  "order_id": 10,
  "product_id": 100,
  "product_value": "50.00",
  "date": "2024-01-15",
  "createdAt": ISODate("2024-01-15T10:30:00.000Z"),
  "updatedAt": ISODate("2024-01-15T10:30:00.000Z")
}
```

#### **√çndices Criados:**
```javascript
// √çndice √∫nico para evitar duplicatas
{
  "user_id": 1,
  "name": 1,
  "order_id": 1,
  "product_id": 1,
  "product_value": 1,
  "date": 1
}

// √çndices para consultas r√°pidas
{ "user_id": 1 }
{ "order_id": 1 }
{ "date": 1 }
```

## üóÑÔ∏è Banco de Dados

### MongoDB - Escolha T√©cnica

**Por que MongoDB?**
- **Dados sem relacionamentos:** Pedidos s√£o independentes
- **Consultas r√°pidas:** √çndices otimizados
- **Flexibilidade:** Schema flexivel
- **Escalabilidade:** Horizontal

### MongoDB Atlas (Produ√ß√£o)

**Configura√ß√£o:**
- **Cluster:** Free Tier (M0)
- **Limita√ß√µes:** Lat√™ncia e mem√≥ria limitadas
- **Regi√£o:** Mais pr√≥xima dos usu√°rios

**Performance Observada:**
| Cen√°rio | Banco Local | Atlas Free | Atlas Pago |
|---------|-------------|------------|------------|
| 4k linhas | < 1s | 3s | < 1s |
| 60k linhas | 3s | 8s | 2s |

**Otimiza√ß√µes Implementadas:**
- ‚úÖ **Inser√ß√£o em lotes** (100 registros)
- ‚úÖ **√çndices compostos** para consultas r√°pidas
- ‚úÖ **Tratamento de duplicatas** eficiente

**Recomenda√ß√µes:**
- Para produ√ß√£o com alto volume: Upgrade para inst√¢ncia paga
- Para desenvolvimento: Banco local √© suficiente
- Monitoramento: CloudWatch para m√©tricas de performance

### √çndices Criados
```javascript
// √çndice composto para evitar duplicatas. Somente se todos os campos forem iguais n√£o ira duplicas.
db.orders.createIndex({
  user_id: 1,
  order_id: 1,
  product_id: 1,
  date: 1
}, { unique: true })
```

### Regra de Duplica√ß√£o
- **S√≥ duplica quando TODOS os campos s√£o iguais**
- user_id + order_id + product_id + date + value
- Garante integridade dos dados

## üîß Qualidade de C√≥digo

### Lint + Husky
```bash
# Verifica√ß√£o autom√°tica no commit
yarn lint          # ESLint
yarn lint:fix        # Ajuste
yarn test:coverage # Cobertura m√≠nima 70%
```

### Hooks do Husky
- **pre-commit:** Lint + Testes
- **commit-msg:** Formato de commit
- **pre-push:** Cobertura de testes

### Formato de Commit
```
type(scope): description

feat(upload): add file validation
fix(search): correct pagination logic
docs(readme): update deployment info
```

## üìä M√©tricas de Qualidade

- **Cobertura de Testes:** 70%+
- **Lint Score:** 100%
- **Build Time:** < 2min
- **Deploy Time:** < 5min

## üöÄ Tecnologias

- **Runtime:** Node.js 20+
- **Framework:** Express.js
- **Banco:** MongoDB
- **ORM:** Mongoose
- **Testes:** Jest
- **Lint:** ESLint + Prettier
- **Deploy:** Railway + Docker
- **CI/CD:** GitHub + Railway

### Limita√ß√µes do MongoDB Atlas Free
- **Lat√™ncia:** Maior que banco local
- **Mem√≥ria:** Limitada para opera√ß√µes grandes
- **Conex√µes:** M√°ximo de 500 conex√µes simult√¢neas
- **Storage:** 512MB m√°ximo

### Performance em Produ√ß√£o
- **Arquivos pequenos (< 10k linhas):** Performance aceit√°vel
- **Arquivos m√©dios (10k-50k linhas):** Pode demorar 3-8s
- **Arquivos grandes (> 1000k linhas):** Recomenda upgrade do cluster

### Estrat√©gias de Otimiza√ß√£o
1. **Processamento em lotes** reduz carga no banco
2. **√çndices bem definidos** aceleram consultas


## üèóÔ∏è Arquitetura da API

### Desenho da API
# Sales Order API - Fluxograma

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                          SALES ORDER API - FLUXOGRAMA                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ      CLIENTE          ‚îÇ        ‚îÇ    ARQUIVO TXT        ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ                                ‚îÇ
             ‚îÇ POST /order/upload             ‚îÇ
             ‚îÇ (multipart/form-data)          ‚îÇ
             ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ
             ‚îÇ                                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                   ‚îÇ
‚îÇ   VALIDA√á√ÉO DO ARQUIVO  ‚îÇ                   ‚îÇ
‚îÇ  ‚úî Formato .txt         ‚îÇ                   ‚îÇ
‚îÇ  ‚úî Estrutura das linhas ‚îÇ                   ‚îÇ
‚îÇ  ‚úî Campos obrigat√≥rios  ‚îÇ                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îÇ
             ‚îÇ                                ‚îÇ
             ‚îÇ Arquivo v√°lido                 ‚îÇ
             ‚îÇ                                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                   ‚îÇ
‚îÇ   PROCESSAMENTO         ‚îÇ                   ‚îÇ
‚îÇ  ‚úî Leitura linha a linha‚îÇ                   ‚îÇ
‚îÇ  ‚úî Convers√£o de datas   ‚îÇ                   ‚îÇ
‚îÇ  ‚úî Agrupamento:         ‚îÇ                   ‚îÇ
‚îÇ    user > orders >      ‚îÇ                   ‚îÇ
‚îÇ    products             ‚îÇ                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îÇ
             ‚îÇ                                ‚îÇ
             ‚îÇ Dados processados              ‚îÇ
             ‚îÇ                                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     PERSIST√äNCIA        ‚îÇ        ‚îÇ     RESPOSTA          ‚îÇ
‚îÇ  ‚úî Inser√ß√£o em lotes    ‚îÇ        ‚îÇ  ‚úî Dados processados  ‚îÇ
‚îÇ  ‚úî Tratamento de        ‚îÇ        ‚îÇ  ‚úî Estat√≠sticas       ‚îÇ
‚îÇ    duplicatas           ‚îÇ        ‚îÇ  ‚úî Estrutura hier√°rq. ‚îÇ
‚îÇ  ‚úî √çndices MongoDB      ‚îÇ        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     CONSULTA            ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§     CLIENTE           ‚îÇ
‚îÇ  ‚úî Filtros:             ‚îÇ        ‚îÇ                       ‚îÇ
‚îÇ    user_id, order_id,   ‚îÇ        ‚îÇ GET /order/search?    ‚îÇ
‚îÇ    date range           ‚îÇ        ‚îÇ Par√¢metros:           ‚îÇ
‚îÇ  ‚úî Pagina√ß√£o            ‚îÇ        ‚îÇ - user_id             ‚îÇ
‚îÇ  ‚úî Agrega√ß√£o de totais  ‚îÇ        ‚îÇ - order_id            ‚îÇ
‚îÇ  ‚úî Estrutura hier√°rquica‚îÇ        ‚îÇ - start/end date      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     RESPOSTA            ‚îÇ
‚îÇ  ‚úî Dados agrupados      ‚îÇ
‚îÇ  ‚úî Metadados pagina√ß√£o  ‚îÇ
‚îÇ  ‚úî Totais calculados    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Componentes Principais

```text
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ   MONGODB     ‚îÇ
           ‚îÇ  ‚ñ† orders     ‚îÇ
           ‚îÇ  ‚ñ† √≠ndices    ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ  API (Node/Express) ‚îÇ
        ‚îÇ  ‚ñ† Upload           ‚îÇ
        ‚îÇ  ‚ñ† Search           ‚îÇ
        ‚îÇ  ‚ñ† Healthcheck      ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ  CLIENTE            ‚îÇ
        ‚îÇ  ‚ñ† Envia arquivos   ‚îÇ
        ‚îÇ  ‚ñ† Consulta dados   ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Fluxo de Erros

```text
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ  ERRO:        ‚îÇ
           ‚îÇ ‚úñ Formato     ‚îÇ
           ‚îÇ ‚úñ Valida√ß√£o   ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ  RESPOSTA DE ERRO   ‚îÇ
        ‚îÇ  ‚ñ† Status code      ‚îÇ
        ‚îÇ  ‚ñ† Mensagem clara   ‚îÇ
        ‚îÇ  ‚ñ† Detalhes         ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```



üìÅ UPLOAD DE ARQUIVOS
‚îú‚îÄ‚îÄ ‚úÖ Apenas arquivos .txt
‚îú‚îÄ‚îÄ ‚úÖ Campos: user_id + name + order_id + product_id + value + date
‚îú‚îÄ‚îÄ ‚úÖ Processamento: todas as linhas ‚Üí agrupamento em lotes de 100 ‚Üí inser√ß√£o no MongoDB
‚îú‚îÄ‚îÄ ‚úÖ Tratamento de duplicatas
‚îú‚îÄ‚îÄ ‚úÖ Formato de data: YYYYMMDD ‚Üí YYYY-MM-DD
‚îî‚îÄ‚îÄ ‚úÖ Agrega√ß√£o por usu√°rio e pedido

üîç BUSCA DE PEDIDOS
‚îú‚îÄ‚îÄ ‚úÖ Filtros: order_id, user_id, start_date, end_date
‚îú‚îÄ‚îÄ ‚úÖ Pagina√ß√£o: page, limit (100 por p√°gina)
‚îú‚îÄ‚îÄ ‚úÖ Par√¢metro "all": retorna todos sem pagina√ß√£o
‚îú‚îÄ‚îÄ ‚úÖ Agrupamento: usu√°rio ‚Üí pedidos ‚Üí produtos
‚îú‚îÄ‚îÄ ‚úÖ C√°lculo de totais por pedido
‚îî‚îÄ‚îÄ ‚úÖ Resposta estruturada com pagina√ß√£o

üè• HEALTHCHECK
‚îú‚îÄ‚îÄ ‚úÖ Status da aplica√ß√£o
‚îú‚îÄ‚îÄ ‚úÖ Conex√£o com MongoDB
‚îú‚îÄ‚îÄ ‚úÖ Informa√ß√µes de vers√£o
‚îî‚îÄ‚îÄ ‚úÖ Timestamp da verifica√ß√£o

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                            TECNOLOGIAS UTILIZADAS                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üü¢ BACKEND
‚îú‚îÄ‚îÄ Node.js + TypeScript
‚îú‚îÄ‚îÄ Express.js (HTTP Server)
‚îú‚îÄ‚îÄ Mongoose (MongoDB ODM)
‚îú‚îÄ‚îÄ Multer (File Upload)
‚îú‚îÄ‚îÄ Swagger UI Express (API Docs)
‚îî‚îÄ‚îÄ Joi (Validation)

üóÑÔ∏è BANCO DE DADOS
‚îú‚îÄ‚îÄ MongoDB Atlas (Produ√ß√£o)
‚îú‚îÄ‚îÄ MongoDB Local (Desenvolvimento)
‚îú‚îÄ‚îÄ √çndices compostos para performance
‚îî‚îÄ‚îÄ Tratamento de duplicatas

üß™ TESTES
‚îú‚îÄ‚îÄ Jest (Framework)
‚îú‚îÄ‚îÄ Supertest (HTTP Testing)
‚îú‚îÄ‚îÄ Cobertura m√≠nima: 70%
‚îú‚îÄ‚îÄ Testes unit√°rios
‚îî‚îÄ‚îÄ Testes de integra√ß√£o

üîß QUALIDADE
‚îú‚îÄ‚îÄ ESLint (Linting)
‚îú‚îÄ‚îÄ Prettier (Formata√ß√£o)
‚îú‚îÄ‚îÄ Husky (Git Hooks)
‚îú‚îÄ‚îÄ Commitlint (Padr√£o de commits)
‚îî‚îÄ‚îÄ TypeScript (Type Safety)

üê≥ CONTAINERIZA√á√ÉO
‚îú‚îÄ‚îÄ Docker (Multi-stage build)
‚îú‚îÄ‚îÄ Docker Compose (Local)
‚îî‚îÄ‚îÄ Railway (Deploy)

üìä MONITORAMENTO
‚îú‚îÄ‚îÄ Healthcheck endpoint
‚îú‚îÄ‚îÄ Error handling
‚îú‚îÄ‚îÄ railway
